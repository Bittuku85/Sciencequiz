<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tournament Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Russo+One:wght@400&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/qrcode-generator/qrcode.js"></script>
    <style>
        :root {
            --bg-primary: #F8FAFC;
            --bg-secondary: #E2E8F0;
            --text-dark: #1E293B;
            --accent-blue: #2563EB;
            --accent-gold: #FBBF24;
            --accent-red: #DC2626;
            --accent-green: #059669;
            --border: #CBD5E1;
            --sidebar-width: 280px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Russo One', sans-serif;
            background: var(--bg-primary);
            color: var(--text-dark);
            overflow-x: hidden;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--accent-blue), #1D4ED8);
            color: white;
            padding: 16px 24px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
        }

        .admin-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .admin-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 72px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 72px);
            background: white;
            border-right: 1px solid var(--border);
            overflow-y: auto;
            z-index: 999;
            transition: transform 0.3s ease;
        }

        .sidebar.mobile-hidden {
            transform: translateX(-100%);
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 24px;
            color: var(--text-dark);
            text-decoration: none;
            transition: all 0.3s ease;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-family: inherit;
            font-size: 16px;
            cursor: pointer;
        }

        .menu-item:hover {
            background: var(--bg-secondary);
        }

        .menu-item.active {
            background: var(--accent-blue);
            color: white;
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            padding: 96px 24px 24px;
            min-height: 100vh;
            transition: margin-left 0.3s ease;
        }

        .main-content.full-width {
            margin-left: 0;
        }

        /* Mobile Toggle */
        .mobile-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }

        /* Content Sections */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .stat-icon.blue { background: rgba(37, 99, 235, 0.1); color: var(--accent-blue); }
        .stat-icon.gold { background: rgba(251, 191, 36, 0.1); color: var(--accent-gold); }
        .stat-icon.green { background: rgba(5, 150, 105, 0.1); color: var(--accent-green); }
        .stat-icon.red { background: rgba(220, 38, 38, 0.1); color: var(--accent-red); }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .stat-label {
            color: #64748B;
            font-size: 14px;
        }

        /* Charts */
        .chart-container {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 24px;
        }

        .chart-title {
            font-size: 20px;
            margin-bottom: 20px;
            color: var(--text-dark);
        }

        /* Tables */
        .table-container {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .table-title {
            font-size: 20px;
            color: var(--text-dark);
        }

        .search-box {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .search-input {
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
            min-width: 200px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--bg-secondary);
            font-weight: bold;
            color: var(--text-dark);
        }

        tr:hover {
            background: var(--bg-primary);
        }

        /* Buttons */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
        }

        .btn-primary:hover {
            background: #1D4ED8;
        }

        .btn-success {
            background: var(--accent-green);
            color: white;
        }

        .btn-danger {
            background: var(--accent-red);
            color: white;
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-dark);
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }

        /* Status Badges */
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-live {
            background: rgba(5, 150, 105, 0.1);
            color: var(--accent-green);
        }

        .status-upcoming {
            background: rgba(251, 191, 36, 0.1);
            color: var(--accent-gold);
        }

        .status-completed {
            background: rgba(100, 116, 139, 0.1);
            color: #64748B;
        }

        .status-pending {
            background: rgba(37, 99, 235, 0.1);
            color: var(--accent-blue);
        }

        .status-verified {
            background: rgba(5, 150, 105, 0.1);
            color: var(--accent-green);
        }

        .status-rejected {
            background: rgba(220, 38, 38, 0.1);
            color: var(--accent-red);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 24px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-dark);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .quick-action-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .quick-action-card:hover {
            transform: translateY(-2px);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .mobile-toggle {
                display: block;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 12px 16px;
            }

            .main-content {
                padding: 80px 16px 16px;
            }

            .search-box {
                flex-direction: column;
                align-items: stretch;
            }

            .search-input {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div style="display: flex; align-items: center; gap: 16px;">
                <button class="mobile-toggle" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo">üèÜ Admin Dashboard</div>
            </div>
            <div class="admin-info">
                <div>
                    <div style="font-size: 14px; opacity: 0.9;">Welcome back,</div>
                    <div style="font-weight: bold;">Admin</div>
                </div>
                <div class="admin-avatar">
                    <i class="fas fa-user-shield"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-menu">
            <button class="menu-item active" onclick="showSection('dashboard')">
                <i class="fas fa-chart-pie"></i>
                Dashboard
            </button>
            <button class="menu-item" onclick="showSection('tournaments')">
                <i class="fas fa-trophy"></i>
                Tournaments
            </button>
            <button class="menu-item" onclick="showSection('players')">
                <i class="fas fa-users"></i>
                Players
            </button>
            <button class="menu-item" onclick="showSection('payments')">
                <i class="fas fa-credit-card"></i>
                Payments
            </button>
            <button class="menu-item" onclick="showSection('analytics')">
                <i class="fas fa-chart-line"></i>
                Analytics
            </button>
            <button class="menu-item" onclick="showSection('settings')">
                <i class="fas fa-cog"></i>
                Settings
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Dashboard Section -->
        <section id="dashboard" class="content-section active">
            <h1 style="margin-bottom: 32px; font-size: 28px;">Dashboard Overview</h1>
            
            <!-- Stats Cards -->
            <div class="dashboard-grid">
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="stat-value" id="totalTournaments">12</div>
                    <div class="stat-label">Total Tournaments</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-value" id="totalPlayers">1,248</div>
                    <div class="stat-label">Registered Players</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon gold">
                        <i class="fas fa-wallet"></i>
                    </div>
                    <div class="stat-value" id="totalRevenue">‚Çπ45,600</div>
                    <div class="stat-label">Total Revenue</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon red">
                        <i class="fas fa-gamepad"></i>
                    </div>
                    <div class="stat-value" id="onlinePlayers">89</div>
                    <div class="stat-label">Online Players</div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <div class="quick-action-card" onclick="openCreateTournamentModal()">
                    <i class="fas fa-plus" style="font-size: 24px; color: var(--accent-blue); margin-bottom: 12px;"></i>
                    <div style="font-weight: bold;">Create Tournament</div>
                </div>
                <div class="quick-action-card" onclick="showSection('payments')">
                    <i class="fas fa-eye" style="font-size: 24px; color: var(--accent-green); margin-bottom: 12px;"></i>
                    <div style="font-weight: bold;">View Payments</div>
                </div>
                <div class="quick-action-card" onclick="sendNotification()">
                    <i class="fas fa-bell" style="font-size: 24px; color: var(--accent-gold); margin-bottom: 12px;"></i>
                    <div style="font-weight: bold;">Send Notification</div>
                </div>
            </div>

            <!-- Charts -->
            <div class="chart-container">
                <div class="chart-title">Revenue Overview (Last 7 Days)</div>
                <canvas id="revenueChart" width="400" height="200"></canvas>
            </div>

            <div class="chart-container">
                <div class="chart-title">Tournament Registrations</div>
                <canvas id="registrationsChart" width="400" height="200"></canvas>
            </div>
        </section>

        <!-- Tournaments Section -->
        <section id="tournaments" class="content-section">
            <div class="table-container">
                <div class="table-header">
                    <h2 class="table-title">Tournament Management</h2>
                    <div class="search-box">
                        <input type="text" class="search-input" placeholder="Search tournaments..." id="tournamentSearch">
                        <button class="btn btn-primary" onclick="openCreateTournamentModal()">
                            <i class="fas fa-plus"></i> Create Tournament
                        </button>
                    </div>
                </div>

                <table id="tournamentsTable">
                    <thead>
                        <tr>
                            <th>Tournament</th>
                            <th>Date & Time</th>
                            <th>Prize Pool</th>
                            <th>Entry Fee</th>
                            <th>Players</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Tournament rows will be populated here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Players Section -->
        <section id="players" class="content-section">
            <div class="table-container">
                <div class="table-header">
                    <h2 class="table-title">Player Management</h2>
                    <div class="search-box">
                        <input type="text" class="search-input" placeholder="Search players..." id="playerSearch">
                        <select class="search-input" style="max-width: 150px;">
                            <option value="">All Players</option>
                            <option value="active">Active</option>
                            <option value="banned">Banned</option>
                        </select>
                    </div>
                </div>

                <table id="playersTable">
                    <thead>
                        <tr>
                            <th>Player</th>
                            <th>FF UID</th>
                            <th>Phone</th>
                            <th>Wallet Balance</th>
                            <th>Tournaments</th>
                            <th>Join Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Player rows will be populated here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Payments Section -->
        <section id="payments" class="content-section">
            <div class="table-container">
                <div class="table-header">
                    <h2 class="table-title">Payment Management</h2>
                    <div class="search-box">
                        <input type="text" class="search-input" placeholder="Search by transaction ID..." id="paymentSearch">
                        <select class="search-input" style="max-width: 150px;" id="paymentStatusFilter">
                            <option value="">All Payments</option>
                            <option value="pending">Pending</option>
                            <option value="verified">Verified</option>
                            <option value="rejected">Rejected</option>
                        </select>
                    </div>
                </div>

                <table id="paymentsTable">
                    <thead>
                        <tr>
                            <th>Transaction ID</th>
                            <th>Player</th>
                            <th>Amount</th>
                            <th>Purpose</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Payment rows will be populated here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analytics" class="content-section">
            <h1 style="margin-bottom: 32px; font-size: 28px;">Advanced Analytics</h1>
            
            <div class="dashboard-grid">
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-value">24.5%</div>
                    <div class="stat-label">Growth Rate</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-value">78%</div>
                    <div class="stat-label">Tournament Fill Rate</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon gold">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="stat-value">‚Çπ156</div>
                    <div class="stat-label">Avg. Revenue per User</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon red">
                        <i class="fas fa-redo"></i>
                    </div>
                    <div class="stat-value">68%</div>
                    <div class="stat-label">Player Retention</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">Daily Active Users</div>
                <canvas id="dailyUsersChart" width="400" height="200"></canvas>
            </div>

            <div class="chart-container">
                <div class="chart-title">Tournament Performance</div>
                <canvas id="tournamentPerformanceChart" width="400" height="200"></canvas>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings" class="content-section">
            <h1 style="margin-bottom: 32px; font-size: 28px;">System Settings</h1>
            
            <div class="table-container" style="margin-bottom: 24px;">
                <h3 style="margin-bottom: 20px;">Payment Gateway Settings</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>UPI ID</label>
                        <input type="text" value="Bittukr@fam" id="upiId">
                    </div>
                    <div class="form-group">
                        <label>Payment Verification</label>
                        <select id="paymentVerification">
                            <option value="manual">Manual Verification</option>
                            <option value="auto">Auto Verification</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="savePaymentSettings()">
                    <i class="fas fa-save"></i> Save Payment Settings
                </button>
            </div>

            <div class="table-container" style="margin-bottom: 24px;">
                <h3 style="margin-bottom: 20px;">Referral Settings</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Referral Bonus (‚Çπ)</label>
                        <input type="number" value="10" id="referralBonus">
                    </div>
                    <div class="form-group">
                        <label>Min Referrals for Bonus</label>
                        <input type="number" value="1" id="minReferrals">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="saveReferralSettings()">
                    <i class="fas fa-save"></i> Save Referral Settings
                </button>
            </div>

            <div class="table-container">
                <h3 style="margin-bottom: 20px;">Admin Users</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Admin User</td>
                            <td>admin@tournament.com</td>
                            <td>Super Admin</td>
                            <td><span class="status-badge status-verified">Active</span></td>
                            <td>
                                <button class="btn btn-secondary btn-small">Edit</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- Create Tournament Modal -->
    <div id="createTournamentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Tournament</h3>
                <button class="close-modal" onclick="closeModal('createTournamentModal')">&times;</button>
            </div>
            
            <form id="createTournamentForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Tournament Title</label>
                        <input type="text" id="tournamentTitle" required>
                    </div>
                    <div class="form-group">
                        <label>Map</label>
                        <select id="tournamentMap" required>
                            <option value="">Select Map</option>
                            <option value="Bermuda">Bermuda</option>
                            <option value="Purgatory">Purgatory</option>
                            <option value="Kalahari">Kalahari</option>
                            <option value="Alpine">Alpine</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" id="tournamentDate" required>
                    </div>
                    <div class="form-group">
                        <label>Time</label>
                        <input type="time" id="tournamentTime" required>
                    </div>
                    <div class="form-group">
                        <label>Prize Pool (‚Çπ)</label>
                        <input type="number" id="tournamentPrize" required>
                    </div>
                    <div class="form-group">
                        <label>Entry Fee (‚Çπ)</label>
                        <input type="number" id="tournamentEntry" required>
                    </div>
                    <div class="form-group">
                        <label>Max Players</label>
                        <input type="number" id="tournamentMaxPlayers" required>
                    </div>
                    <div class="form-group">
                        <label>Room ID</label>
                        <input type="text" id="tournamentRoomId" required>
                    </div>
                    <div class="form-group full-width">
                        <label>Room Password</label>
                        <input type="text" id="tournamentRoomPass" required>
                    </div>
                </div>
                
                <div style="display: flex; gap: 12px; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('createTournamentModal')">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Create Tournament
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Payment Details Modal -->
    <div id="paymentDetailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Payment Details</h3>
                <button class="close-modal" onclick="closeModal('paymentDetailsModal')">&times;</button>
            </div>
            
            <div id="paymentDetailsContent">
                <!-- Payment details will be populated here -->
            </div>
            
            <div style="display: flex; gap: 12px; margin-top: 20px;">
                <button class="btn btn-danger" onclick="rejectPayment()">
                    <i class="fas fa-times"></i> Reject
                </button>
                <button class="btn btn-success" onclick="verifyPayment()">
                    <i class="fas fa-check"></i> Verify Payment
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        // Firebase Configuration
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, onSnapshot, query, orderBy, where } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            // Add your Firebase config here
            apiKey: "your-api-key",
            authDomain: "your-project.firebaseapp.com",
            projectId: "your-project-id",
            storageBucket: "your-project.appspot.com",
            messagingSenderId: "123456789",
            appId: "your-app-id"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // Global variables
        let currentAdmin = null;
        let tournaments = [];
        let players = [];
        let payments = [];
        let selectedPayment = null;

        // Initialize app
        window.addEventListener('DOMContentLoaded', () => {
            initializeAuth();
            loadDashboardData();
            initializeCharts();
        });

        // Authentication
        function initializeAuth() {
            // For demo purposes, we'll simulate admin login
            // In production, implement proper admin authentication
            currentAdmin = { uid: 'admin123', email: 'admin@tournament.com' };
            loadAllData();
        }

        // Load all data
        function loadAllData() {
            loadTournaments();
            loadPlayers();
            loadPayments();
            updateDashboardStats();
        }

        // Dashboard functions
        function updateDashboardStats() {
            // Simulate real-time stats
            document.getElementById('totalTournaments').textContent = tournaments.length || 12;
            document.getElementById('totalPlayers').textContent = players.length || 1248;
            document.getElementById('totalRevenue').textContent = '‚Çπ45,600';
            document.getElementById('onlinePlayers').textContent = Math.floor(Math.random() * 100) + 50;
        }

        // Tournament management
        function loadTournaments() {
            // Mock tournament data
            tournaments = [
                {
                    id: 'tour1',
                    title: 'Free Fire Championship',
                    date: '2024-01-20',
                    time: '18:00',
                    map: 'Bermuda',
                    prize: 1000,
                    entryFee: 50,
                    maxPlayers: 100,
                    currentPlayers: 45,
                    status: 'live',
                    roomId: '12345',
                    roomPass: 'FF2024'
                },
                {
                    id: 'tour2',
                    title: 'Evening Battle Royale',
                    date: '2024-01-20',
                    time: '20:00',
                    map: 'Purgatory',
                    prize: 500,
                    entryFee: 25,
                    maxPlayers: 50,
                    currentPlayers: 23,
                    status: 'upcoming',
                    roomId: '67890',
                    roomPass: 'BATTLE'
                },
                {
                    id: 'tour3',
                    title: 'Pro League Final',
                    date: '2024-01-19',
                    time: '19:00',
                    map: 'Kalahari',
                    prize: 2000,
                    entryFee: 100,
                    maxPlayers: 200,
                    currentPlayers: 200,
                    status: 'completed',
                    roomId: '11111',
                    roomPass: 'FINAL'
                }
            ];

            displayTournaments();
        }

        function displayTournaments() {
            const tbody = document.querySelector('#tournamentsTable tbody');
            tbody.innerHTML = tournaments.map(tournament => `
                <tr>
                    <td>
                        <div style="font-weight: bold;">${tournament.title}</div>
                        <div style="font-size: 12px; color: #64748B;">${tournament.map}</div>
                    </td>
                    <td>${tournament.date} ${tournament.time}</td>
                    <td>‚Çπ${tournament.prize}</td>
                    <td>‚Çπ${tournament.entryFee}</td>
                    <td>${tournament.currentPlayers}/${tournament.maxPlayers}</td>
                    <td><span class="status-badge status-${tournament.status}">${tournament.status}</span></td>
                    <td>
                        <button class="btn btn-secondary btn-small" onclick="editTournament('${tournament.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="deleteTournament('${tournament.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // Player management
        function loadPlayers() {
            // Mock player data
            players = [
                {
                    id: 'player1',
                    name: 'Rohan Kumar',
                    ffUID: '987654321',
                    phone: '+91 9876543210',
                    walletBalance: 150,
                    tournaments: 3,
                    joinDate: '2024-01-15',
                    status: 'active'
                },
                {
                    id: 'player2',
                    name: 'Priya Sharma',
                    ffUID: '123456789',
                    phone: '+91 8765432109',
                    walletBalance: 75,
                    tournaments: 1,
                    joinDate: '2024-01-18',
                    status: 'active'
                },
                {
                    id: 'player3',
                    name: 'Amit Singh',
                    ffUID: '456789123',
                    phone: '+91 7654321098',
                    walletBalance: 0,
                    tournaments: 5,
                    joinDate: '2024-01-10',
                    status: 'active'
                }
            ];

            displayPlayers();
        }

        function displayPlayers() {
            const tbody = document.querySelector('#playersTable tbody');
            tbody.innerHTML = players.map(player => `
                <tr>
                    <td>
                        <div style="font-weight: bold;">${player.name}</div>
                        <div style="font-size: 12px; color: #64748B;">${player.status}</div>
                    </td>
                    <td>${player.ffUID}</td>
                    <td>${player.phone}</td>
                    <td>‚Çπ${player.walletBalance}</td>
                    <td>${player.tournaments}</td>
                    <td>${player.joinDate}</td>
                    <td>
                        <button class="btn btn-secondary btn-small" onclick="viewPlayer('${player.id}')">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="banPlayer('${player.id}')">
                            <i class="fas fa-ban"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // Payment management
        function loadPayments() {
            // Mock payment data
            payments = [
                {
                    id: 'pay1',
                    transactionId: 'TXN123456789',
                    playerName: 'Rohan Kumar',
                    amount: 50,
                    purpose: 'Tournament Entry - Free Fire Championship',
                    date: '2024-01-20 14:30',
                    status: 'pending'
                },
                {
                    id: 'pay2',
                    transactionId: 'TXN987654321',
                    playerName: 'Priya Sharma',
                    amount: 100,
                    purpose: 'Wallet Topup',
                    date: '2024-01-20 12:15',
                    status: 'verified'
                },
                {
                    id: 'pay3',
                    transactionId: 'TXN456789123',
                    playerName: 'Amit Singh',
                    amount: 25,
                    purpose: 'Tournament Entry - Evening Battle Royale',
                    date: '2024-01-20 10:45',
                    status: 'rejected'
                }
            ];

            displayPayments();
        }

        function displayPayments() {
            const tbody = document.querySelector('#paymentsTable tbody');
            tbody.innerHTML = payments.map(payment => `
                <tr>
                    <td>
                        <div style="font-weight: bold;">${payment.transactionId}</div>
                        <div style="font-size: 12px; color: #64748B;">UPI: Bittukr@fam</div>
                    </td>
                    <td>${payment.playerName}</td>
                    <td>‚Çπ${payment.amount}</td>
                    <td>${payment.purpose}</td>
                    <td>${payment.date}</td>
                    <td><span class="status-badge status-${payment.status}">${payment.status}</span></td>
                    <td>
                        <button class="btn btn-secondary btn-small" onclick="viewPaymentDetails('${payment.id}')">
                            <i class="fas fa-eye"></i>
                        </button>
                        ${payment.status === 'pending' ? `
                            <button class="btn btn-success btn-small" onclick="quickVerifyPayment('${payment.id}')">
                                <i class="fas fa-check"></i>
                            </button>
                        ` : ''}
                    </td>
                </tr>
            `).join('');
        }

        // Modal functions
        window.openCreateTournamentModal = function() {
            document.getElementById('createTournamentModal').classList.add('active');
        };

        window.closeModal = function(modalId) {
            document.getElementById(modalId).classList.remove('active');
        };

        // Tournament form submission
        document.getElementById('createTournamentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newTournament = {
                id: 'tour' + Date.now(),
                title: document.getElementById('tournamentTitle').value,
                date: document.getElementById('tournamentDate').value,
                time: document.getElementById('tournamentTime').value,
                map: document.getElementById('tournamentMap').value,
                prize: parseInt(document.getElementById('tournamentPrize').value),
                entryFee: parseInt(document.getElementById('tournamentEntry').value),
                maxPlayers: parseInt(document.getElementById('tournamentMaxPlayers').value),
                currentPlayers: 0,
                status: 'upcoming',
                roomId: document.getElementById('tournamentRoomId').value,
                roomPass: document.getElementById('tournamentRoomPass').value
            };

            tournaments.unshift(newTournament);
            displayTournaments();
            closeModal('createTournamentModal');
            alert('Tournament created successfully!');
            
            // Reset form
            document.getElementById('createTournamentForm').reset();
        });

        // Payment functions
        window.viewPaymentDetails = function(paymentId) {
            selectedPayment = payments.find(p => p.id === paymentId);
            if (!selectedPayment) return;

            document.getElementById('paymentDetailsContent').innerHTML = `
                <div class="form-group">
                    <label>Transaction ID</label>
                    <div style="padding: 8px; background: var(--bg-secondary); border-radius: 4px;">
                        ${selectedPayment.transactionId}
                    </div>
                </div>
                <div class="form-group">
                    <label>Player</label>
                    <div style="padding: 8px; background: var(--bg-secondary); border-radius: 4px;">
                        ${selectedPayment.playerName}
                    </div>
                </div>
                <div class="form-group">
                    <label>Amount</label>
                    <div style="padding: 8px; background: var(--bg-secondary); border-radius: 4px;">
                        ‚Çπ${selectedPayment.amount}
                    </div>
                </div>
                <div class="form-group">
                    <label>Purpose</label>
                    <div style="padding: 8px; background: var(--bg-secondary); border-radius: 4px;">
                        ${selectedPayment.purpose}
                    </div>
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <div style="padding: 8px; background: var(--bg-secondary); border-radius: 4px;">
                        <span class="status-badge status-${selectedPayment.status}">${selectedPayment.status}</span>
                    </div>
                </div>
                <div class="form-group">
                    <label>Payment Method</label>
                    <div style="padding: 8px; background: var(--bg-secondary); border-radius: 4px;">
                        UPI - Bittukr@fam
                    </div>
                </div>
            `;

            document.getElementById('paymentDetailsModal').classList.add('active');
        };

        window.quickVerifyPayment = function(paymentId) {
            const payment = payments.find(p => p.id === paymentId);
            if (payment) {
                payment.status = 'verified';
                displayPayments();
                alert('Payment verified successfully!');
            }
        };

        window.verifyPayment = function() {
            if (selectedPayment) {
                selectedPayment.status = 'verified';
                displayPayments();
                closeModal('paymentDetailsModal');
                alert('Payment verified successfully!');
            }
        };

        window.rejectPayment = function() {
            if (selectedPayment) {
                selectedPayment.status = 'rejected';
                displayPayments();
                closeModal('paymentDetailsModal');
                alert('Payment rejected!');
            }
        };

        // Other functions
        window.editTournament = function(tournamentId) {
            alert('Edit tournament feature will be implemented');
        };

        window.deleteTournament = function(tournamentId) {
            if (confirm('Are you sure you want to delete this tournament?')) {
                tournaments = tournaments.filter(t => t.id !== tournamentId);
                displayTournaments();
                alert('Tournament deleted successfully!');
            }
        };

        window.viewPlayer = function(playerId) {
            alert('View player details feature will be implemented');
        };

        window.banPlayer = function(playerId) {
            if (confirm('Are you sure you want to ban this player?')) {
                const player = players.find(p => p.id === playerId);
                if (player) {
                    player.status = 'banned';
                    displayPlayers();
                    alert('Player banned successfully!');
                }
            }
        };

        window.sendNotification = function() {
            alert('Send notification feature will be implemented');
        };

        window.savePaymentSettings = function() {
            alert('Payment settings saved successfully!');
        };

        window.saveReferralSettings = function() {
            alert('Referral settings saved successfully!');
        };

        // Navigation functions
        window.showSection = function(sectionName) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionName).classList.add('active');

            // Add active class to clicked menu item
            event.target.classList.add('active');

            // Close sidebar on mobile
            if (window.innerWidth <= 1024) {
                document.getElementById('sidebar').classList.remove('mobile-open');
            }
        };

        window.toggleSidebar = function() {
            document.getElementById('sidebar').classList.toggle('mobile-open');
        };

        // Charts initialization
        function initializeCharts() {
            // Revenue Chart
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            new Chart(revenueCtx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Revenue (‚Çπ)',
                        data: [1200, 1900, 3000, 5000, 2000, 3000, 4500],
                        borderColor: '#2563EB',
                        backgroundColor: 'rgba(37, 99, 235, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Registrations Chart
            const registrationsCtx = document.getElementById('registrationsChart').getContext('2d');
            new Chart(registrationsCtx, {
                type: 'bar',
                data: {
                    labels: ['FF Championship', 'Battle Royale', 'Pro League', 'Night Cup', 'Weekend War'],
                    datasets: [{
                        label: 'Registrations',
                        data: [45, 23, 200, 67, 89],
                        backgroundColor: ['#2563EB', '#059669', '#FBBF24', '#DC2626', '#8B5CF6']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Daily Users Chart
            const dailyUsersCtx = document.getElementById('dailyUsersChart').getContext('2d');
            new Chart(dailyUsersCtx, {
                type: 'line',
                data: {
                    labels: ['1 Jan', '2 Jan', '3 Jan', '4 Jan', '5 Jan', '6 Jan', '7 Jan'],
                    datasets: [{
                        label: 'Active Users',
                        data: [120, 190, 300, 500, 200, 300, 450],
                        borderColor: '#059669',
                        backgroundColor: 'rgba(5, 150, 105, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Tournament Performance Chart
            const performanceCtx = document.getElementById('tournamentPerformanceChart').getContext('2d');
            new Chart(performanceCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Completed', 'Live', 'Upcoming', 'Cancelled'],
                    datasets: [{
                        data: [45, 12, 25, 3],
                        backgroundColor: ['#059669', '#2563EB', '#FBBF24', '#DC2626']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Search functionality
        document.getElementById('tournamentSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#tournamentsTable tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        document.getElementById('playerSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#playersTable tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        document.getElementById('paymentSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#paymentsTable tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Real-time updates simulation
        setInterval(() => {
            updateDashboardStats();
        }, 30000); // Update every 30 seconds

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });
    </script>
</body>
</html>